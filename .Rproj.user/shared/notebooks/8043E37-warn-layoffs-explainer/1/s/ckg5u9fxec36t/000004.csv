"0",""
"0","# define data frame"
"0","warn_detail <- tibble("
"0","  "
"0","  page_name = character( ),"
"0","  row_num = numeric( ),"
"0","  id = character( ), # there are no leading zeros, so treat it as a numeral"
"0","  company = character( ),"
"0","  co_st_address = character( ),"
"0","  co_hq_city = character( ),"
"0","  co_hq_state = character( ),"
"0","  co_hq_zip = character( ),"
"0","  num_employees_affected = numeric( ),"
"0","  other_notes = character( )"
"0","  "
"0",")"
"0",""
"0","# create a list of files"
"0","file_list <- list.files( path= ""company_urls/warn"" )"
"0",""
"0","n <- length( file_list )"
"0",""
"0","# loop through every scraped file to parse the data"
"0","for (i in 1:n ) {"
"0","  "
"0","  file_name <- file_list[ i ] %>% as.character( )"
"0","  "
"0","  my_html <- read_html( paste0( ""company_urls/warn/"", file_name ) )"
"0","  "
"0","  my_table <- html_table( html_nodes( my_html, ""table"" )[[2]])"
"0","  "
"0","  table_length <- nrow( my_table )"
"0","  "
"0","  if( table_length < 7 ) {"
"0","    r = tribble( "
"0","      ~X1, ~X2,"
"0","      ""Other Notes"", """" )"
"0","    "
"0","    my_table <- bind_rows( my_table, r )"
"0","  }"
"0","  "
"0","  warn_row <- my_table %>%"
"0","    pivot_wider( names_from = X1, values_from = X2 ) %>%"
"0","    mutate("
"0","      id = str_extract(file_name, ""\\d{1,4}""),"
"0","      page_name = file_name,"
"0","      row_num = i,"
"0","      num_employees_affected = `Number of employees affected` %>% as.numeric( ),"
"0","      other_notes = `Other Notes`"
"0","    ) %>% "
"0","    # re-order and rename columns to match data-frame"
"0","    select("
"0","      page_name, "
"0","      row_num, "
"0","      id, "
"0","      company = `Company name`,"
"0","      co_st_address = `Street address`,"
"0","      co_hq_city = `City`,"
"0","      co_hq_state = `State`,"
"0","      co_hq_zip = `Zip code`,"
"0","      num_employees_affected,"
"0","      other_notes"
"0","    )"
"0","  "
"0","  warn_detail <- bind_rows( warn_detail, warn_row  )"
"0","  "
"0","}"
"0",""
"0","# woohoo!"
"0",""
"0","# make sure to save your results:"
"0","date_curr = today( )"
"0",""
"0","save_location = paste0("
"0","  ""output/"","
"0","  date_curr,"
"0","  ""/warn_detail.csv"""
"0",")"
"0",""
"0","write_csv( warn_detail, save_location )"
"0",""
